{
  "timestamp": "2025-11-02T22:31:06.598Z",
  "assessment": {
    "category": 2,
    "status": "‚ùå CRITICAL",
    "message": "Table exists but missing CRITICAL columns - BLOCKING",
    "canProceed": false
  },
  "results": {
    "columns": {
      "status": "critical",
      "missing": [
        "timestamp",
        "config",
        "file_size",
        "file_url",
        "created_at",
        "updated_at"
      ],
      "criticalMissing": [
        "config"
      ],
      "extra": [
        "scope",
        "filter_state",
        "conversation_ids",
        "file_name",
        "file_size_bytes",
        "file_path",
        "compressed",
        "metadata",
        "quality_stats",
        "tier_distribution",
        "include_metadata",
        "include_quality_scores",
        "include_timestamps",
        "include_approval_history",
        "exported_at",
        "downloaded_count",
        "last_downloaded_at"
      ],
      "actual": [
        "id",
        "export_id",
        "user_id",
        "scope",
        "format",
        "filter_state",
        "conversation_ids",
        "conversation_count",
        "file_name",
        "file_size_bytes",
        "file_path",
        "compressed",
        "metadata",
        "quality_stats",
        "tier_distribution",
        "status",
        "error_message",
        "include_metadata",
        "include_quality_scores",
        "include_timestamps",
        "include_approval_history",
        "exported_at",
        "expires_at",
        "downloaded_count",
        "last_downloaded_at"
      ]
    },
    "indexes": {
      "status": "ok",
      "missing": [
        "idx_export_logs_timestamp",
        "idx_export_logs_expires_at"
      ],
      "actual": [
        "export_logs_export_id_key",
        "export_logs_pkey",
        "idx_export_logs_export_id",
        "idx_export_logs_exported_at",
        "idx_export_logs_format",
        "idx_export_logs_status",
        "idx_export_logs_user_id"
      ]
    },
    "policies": {
      "status": "warning",
      "missing": [
        "UPDATE"
      ],
      "actual": [
        {
          "policyname": "Users can create their own export logs",
          "cmd": "INSERT",
          "qual": null,
          "with_check": "(auth.uid() = user_id)"
        },
        {
          "policyname": "Users can view their own export logs",
          "cmd": "SELECT",
          "qual": "(auth.uid() = user_id)",
          "with_check": null
        }
      ]
    },
    "constraints": {
      "status": "ok",
      "types": {
        "CHECK": 3,
        "FOREIGN KEY": 1,
        "PRIMARY KEY": 1,
        "UNIQUE": 1
      }
    },
    "rls": {
      "enabled": true
    }
  },
  "schema": {
    "columns": [
      {
        "column_name": "id",
        "data_type": "uuid",
        "is_nullable": "NO",
        "column_default": "uuid_generate_v4()",
        "ordinal_position": 1
      },
      {
        "column_name": "export_id",
        "data_type": "uuid",
        "is_nullable": "NO",
        "column_default": "uuid_generate_v4()",
        "ordinal_position": 2
      },
      {
        "column_name": "user_id",
        "data_type": "uuid",
        "is_nullable": "NO",
        "column_default": null,
        "ordinal_position": 3
      },
      {
        "column_name": "scope",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 4
      },
      {
        "column_name": "format",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 5
      },
      {
        "column_name": "filter_state",
        "data_type": "jsonb",
        "is_nullable": "NO",
        "column_default": null,
        "ordinal_position": 6
      },
      {
        "column_name": "conversation_ids",
        "data_type": "ARRAY",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 7
      },
      {
        "column_name": "conversation_count",
        "data_type": "integer",
        "is_nullable": "NO",
        "column_default": null,
        "ordinal_position": 8
      },
      {
        "column_name": "file_name",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 9
      },
      {
        "column_name": "file_size_bytes",
        "data_type": "bigint",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 10
      },
      {
        "column_name": "file_path",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 11
      },
      {
        "column_name": "compressed",
        "data_type": "boolean",
        "is_nullable": "YES",
        "column_default": "false",
        "ordinal_position": 12
      },
      {
        "column_name": "metadata",
        "data_type": "jsonb",
        "is_nullable": "YES",
        "column_default": "'{}'::jsonb",
        "ordinal_position": 13
      },
      {
        "column_name": "quality_stats",
        "data_type": "jsonb",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 14
      },
      {
        "column_name": "tier_distribution",
        "data_type": "jsonb",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 15
      },
      {
        "column_name": "status",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 16
      },
      {
        "column_name": "error_message",
        "data_type": "text",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 17
      },
      {
        "column_name": "include_metadata",
        "data_type": "boolean",
        "is_nullable": "YES",
        "column_default": "true",
        "ordinal_position": 18
      },
      {
        "column_name": "include_quality_scores",
        "data_type": "boolean",
        "is_nullable": "YES",
        "column_default": "true",
        "ordinal_position": 19
      },
      {
        "column_name": "include_timestamps",
        "data_type": "boolean",
        "is_nullable": "YES",
        "column_default": "true",
        "ordinal_position": 20
      },
      {
        "column_name": "include_approval_history",
        "data_type": "boolean",
        "is_nullable": "YES",
        "column_default": "false",
        "ordinal_position": 21
      },
      {
        "column_name": "exported_at",
        "data_type": "timestamp with time zone",
        "is_nullable": "YES",
        "column_default": "now()",
        "ordinal_position": 22
      },
      {
        "column_name": "expires_at",
        "data_type": "timestamp with time zone",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 23
      },
      {
        "column_name": "downloaded_count",
        "data_type": "integer",
        "is_nullable": "YES",
        "column_default": "0",
        "ordinal_position": 24
      },
      {
        "column_name": "last_downloaded_at",
        "data_type": "timestamp with time zone",
        "is_nullable": "YES",
        "column_default": null,
        "ordinal_position": 25
      }
    ],
    "indexes": [
      {
        "indexname": "export_logs_export_id_key",
        "indexdef": "CREATE UNIQUE INDEX export_logs_export_id_key ON public.export_logs USING btree (export_id)"
      },
      {
        "indexname": "export_logs_pkey",
        "indexdef": "CREATE UNIQUE INDEX export_logs_pkey ON public.export_logs USING btree (id)"
      },
      {
        "indexname": "idx_export_logs_export_id",
        "indexdef": "CREATE INDEX idx_export_logs_export_id ON public.export_logs USING btree (export_id)"
      },
      {
        "indexname": "idx_export_logs_exported_at",
        "indexdef": "CREATE INDEX idx_export_logs_exported_at ON public.export_logs USING btree (exported_at DESC)"
      },
      {
        "indexname": "idx_export_logs_format",
        "indexdef": "CREATE INDEX idx_export_logs_format ON public.export_logs USING btree (format)"
      },
      {
        "indexname": "idx_export_logs_status",
        "indexdef": "CREATE INDEX idx_export_logs_status ON public.export_logs USING btree (status)"
      },
      {
        "indexname": "idx_export_logs_user_id",
        "indexdef": "CREATE INDEX idx_export_logs_user_id ON public.export_logs USING btree (user_id)"
      }
    ],
    "constraints": [
      {
        "constraint_name": "export_logs_format_check",
        "constraint_type": "CHECK",
        "definition": "CHECK ((format = ANY (ARRAY['json'::text, 'jsonl'::text, 'csv'::text, 'markdown'::text])))"
      },
      {
        "constraint_name": "export_logs_scope_check",
        "constraint_type": "CHECK",
        "definition": "CHECK ((scope = ANY (ARRAY['selected'::text, 'filtered'::text, 'all'::text])))"
      },
      {
        "constraint_name": "export_logs_status_check",
        "constraint_type": "CHECK",
        "definition": "CHECK ((status = ANY (ARRAY['pending'::text, 'processing'::text, 'completed'::text, 'failed'::text])))"
      },
      {
        "constraint_name": "export_logs_user_id_fkey",
        "constraint_type": "FOREIGN KEY",
        "definition": "FOREIGN KEY (user_id) REFERENCES user_profiles(id)"
      },
      {
        "constraint_name": "export_logs_pkey",
        "constraint_type": "PRIMARY KEY",
        "definition": "PRIMARY KEY (id)"
      },
      {
        "constraint_name": "export_logs_export_id_key",
        "constraint_type": "UNIQUE",
        "definition": "UNIQUE (export_id)"
      }
    ],
    "rls_policies": [
      {
        "policyname": "Users can create their own export logs",
        "cmd": "INSERT",
        "qual": null,
        "with_check": "(auth.uid() = user_id)"
      },
      {
        "policyname": "Users can view their own export logs",
        "cmd": "SELECT",
        "qual": "(auth.uid() = user_id)",
        "with_check": null
      }
    ],
    "rls_enabled": true,
    "table_exists": true,
    "row_count": 0
  }
}